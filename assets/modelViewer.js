import"./modulepreload-polyfill.js";import{s as I,_ as L,j as U,M as v,p as B,r as D,g as E,w as O,z as S}from"./gltf-io.js";import{M as j}from"./manifold.js";const w=I(new L),e=new U,M=await j();M.setup();const{Manifold:i,Mesh:k}=M,f=new Map;async function R(o){const a=Array(),c=await w.read(o);await c.transform(v());const d=c.getRoot().listNodes(),h=Array();for(const t of d){B(t);const r=t.getMesh();if(r==null)continue;const s=D(r);if(s==null)continue;const m=s.runProperties.length,u=i.reserveIDs(m);s.mesh.runOriginalID=new Uint32Array(m);for(let n=0;n<m;++n)s.mesh.runOriginalID[n]=u+n,h.push(u+n),f.set(u+n,s.runProperties[n]);a.push(new i(new k(s.mesh)))}const y=e.getRoot().listMaterials().length;e.merge(c),e.getRoot().listScenes().forEach(t=>t.dispose()),e.getRoot().listBuffers().forEach(t=>t.dispose()),e.getRoot().listAccessors().forEach(t=>t.dispose());for(const[t,r]of h.entries()){const s=e.getRoot().listMaterials()[y+t];f.get(r).material=s}return i.union(a)}const A=await R("/models/space.glb"),q=await R("/models/moon.glb"),p=e.createNode();e.createScene().addChild(p);function b(o){P(i[o](A,q))}b("difference");const g=document.querySelector("select");g.onchange=function(){b(g.value)};let l="";const z=document.querySelector("#download");z.onclick=function(){const o=document.createElement("a");o.download="manifold.glb",o.href=l,o.click()};const N=document.querySelector("model-viewer");async function P(o){E(p.getMesh());const a=O(e,o.getMesh(),f);p.setMesh(a),await e.transform(S());const c=await w.writeBinary(e),d=new Blob([c],{type:"application/octet-stream"});URL.revokeObjectURL(l),l=URL.createObjectURL(d),N.src=l}
//# sourceMappingURL=modelViewer.js.map
